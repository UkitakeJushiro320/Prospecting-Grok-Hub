-- ðŸŒŸ Grok's Prospecting! Hub v2.2 â€“ Clean & Debugged (January 2026)
-- Use on alt account only! Devs ban fast.

print("[GROK HUB] Script started loading...")

getgenv().Config = getgenv().Config or {}

-- Services
local Players           = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local HttpService       = game:GetService("HttpService")
local TeleportService   = game:GetService("TeleportService")
local RunService        = game:GetService("RunService")
local UserInputService  = game:GetService("UserInputService")
local Workspace         = game:GetService("Workspace")

local plr  = Players.LocalPlayer
local char = plr.Character or plr.CharacterAdded:Wait()
local hrp  = char:WaitForChild("HumanoidRootPart")

print("[GROK HUB] Services loaded")

-- Remotes (MUST VERIFY WITH DEX EXPLORER â€“ these are common names only)
local RemotesFolder = ReplicatedStorage:FindFirstChild("Remotes") or ReplicatedStorage:FindFirstChild("Events") or ReplicatedStorage
local SellAllRemote    = RemotesFolder:FindFirstChild("SellAll") or RemotesFolder:FindFirstChild("SellInventory")
local LockRemote       = RemotesFolder:FindFirstChild("FavoriteItem") or RemotesFolder:FindFirstChild("LockItem")
local GetInvRemote     = RemotesFolder:FindFirstChild("GetInventory")
local PlaceTotemRemote = RemotesFolder:FindFirstChild("PlaceTotem")
local BuyTotemRemote   = RemotesFolder:FindFirstChild("BuyTotem")
local EnchantRemote    = RemotesFolder:FindFirstChild("EnchantTool")
local ReforgeRemote    = RemotesFolder:FindFirstChild("Reforge")
local ExcavRemote      = RemotesFolder:FindFirstChild("StartExcavation")
local UseItemRemote    = RemotesFolder:FindFirstChild("UseItem")

print("[GROK HUB] Remotes attempted to locate")

-- Positions
getgenv().SandCFrame  = CFrame.new()
getgenv().WaterCFrame = CFrame.new()

-- Helper: Check for active world events
local function HasEvent(name)
    return Workspace:FindFirstChild(name) or Workspace:FindFirstChild(name.."Event")
end

-- Server hop function
local function ServerHop()
    local success, data = pcall(function()
        return HttpService:JSONDecode(game:HttpGet("https://games.roblox.com/v1/games/"..game.PlaceId.."/servers/Public?sortOrder=Asc&limit=100"))
    end)
    if success and data.data then
        for _, v in ipairs(data.data) do
            if v.playing < v.maxPlayers * 0.8 and v.id ~= game.JobId then
                TeleportService:TeleportToPlaceInstance(game.PlaceId, v.id)
                return
            end
        end
    end
end

print("[GROK HUB] Attempting to load UI library...")

-- Use a more reliable mirror for Kavo (2026 community fork)
local success, Library = pcall(function()
    return loadstring(game:HttpGet("https://raw.githubusercontent.com/teppyboy/Kavo-UI/main/Kavo.lua"))()
end)

if not success or not Library then
    warn("[GROK HUB] FAILED TO LOAD KAVO UI â€“ Check executor / internet")
    return
end

print("[GROK HUB] Kavo library loaded successfully")

local Window = Library.CreateLib("Grok Prospecting Hub â€“ v2.2", "DarkTheme")
print("[GROK HUB] Main window created")

-- ========== MAIN TAB ==========
local MainTab = Window:NewTab("Main")
local ItemsSec = MainTab:NewSection("<< Items >>")
local AFKSec   = MainTab:NewSection("<< AFK Panning + Totem >>")
local TreasSec = MainTab:NewSection("<< Treasure Map >>")
local EnchSec  = MainTab:NewSection("<< Auto Enchant >>")
local LockSec  = MainTab:NewSection("<< Auto Lock >>")
local RefSec   = MainTab:NewSection("<< Auto Reforge >>")
local ExcSec   = MainTab:NewSection("<< Excavation >>")

-- Items section (basic toggles)
ItemsSec:NewToggle("Auto Sell All", "Sells when full", function(s) getgenv().AutoSell = s end)
ItemsSec:NewToggle("TP to Merchant", "", function(s) getgenv().TPMerchant = s end)

-- AFK Panning + Totem
AFKSec:NewDropdown("Totem Type", "", {"Luck", "Strength", "Luminant"}, function(v) getgenv().TotemType = v end)
AFKSec:NewToggle("Auto Buy Totem if 0", "", function(s) getgenv().AutoBuyTotem = s end)
AFKSec:NewToggle("AFK Pan + Place Totem", "Main AFK combo", function(s)
    getgenv().AFKPanTotem = s
    spawn(function()
        while getgenv().AFKPanTotem do
            if getgenv().SandCFrame then hrp.CFrame = getgenv().SandCFrame end
            wait(0.4)
            pcall(function() PlaceTotemRemote:FireServer(getgenv().TotemType) end)
            if getgenv().AutoBuyTotem then
                pcall(function() BuyTotemRemote:FireServer(getgenv().TotemType, 1) end)
            end
            wait(290)
        end
    end)
end)

-- Add more sections/toggles similarly (Treasure, Enchant, Lock, Reforge, Excav...)
-- Example placeholder for Treasure:
TreasSec:NewToggle("Auto Dig Treasure Map", "", function(s) getgenv().AutoTreasure = s end)

print("[GROK HUB] Main tab sections created")

-- ========== PANNING TAB ==========
local PanTab = Window:NewTab("Panning")
local PanSec = PanTab:NewSection("Panning Controls")

PanSec:NewButton("Set Sand Position", "Stand on sand and click", function()
    getgenv().SandCFrame = hrp.CFrame
    game.StarterGui:SetCore("SendNotification", {Title="Position Set", Text="Sand saved", Duration=3})
end)

PanSec:NewButton("Set Water Position", "Stand in water and click", function()
    getgenv().WaterCFrame = hrp.CFrame
    game.StarterGui:SetCore("SendNotification", {Title="Position Set", Text="Water saved", Duration=3})
end)

PanSec:NewToggle("Auto Fill Pan", "", function(s) getgenv().FillPan = s end)
PanSec:NewToggle("Auto Shake Pan", "", function(s) getgenv().ShakePan = s end)

-- ========== END & NOTIFICATION ==========
print("[GROK HUB] Full script executed â€“ GUI should be visible now")
game.StarterGui:SetCore("SendNotification", {
    Title = "Grok Hub v2.2",
    Text = "Loaded! If no GUI â†’ check console (F9)",
    Duration = 8
})
